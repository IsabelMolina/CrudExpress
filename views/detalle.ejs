<%- include("template/cabecera", {titulo: "Crear nueva mascota"}) %>
    <div class="container">
      <h1><%= titulo %></h1>
      <% if(error) { %>
        <p><%= mensaje %></p>

          <a href="/mascotas" class="btn btn-dark btn-block">volver Mascota</a>


      <% } else { %>
        <form id="formularioEditar" data-id="<%= mascota.id %>" >
          <div class="form-group">
            <label for="nombre">Nombre</label>
            <input type="text" class="form-control" name="nombre" id="nombre" value="<%= mascota.nombre %>">
          </div>
          <div class="form-group">
            <label for="descripcion">Descripion</label>
            <input type="text" class="form-control" name="descripcion" id="descripcion"  value="<%= mascota.descripcion %>">
          </div>
          <button type="submit" class="btn btn-warning" >Editar</button>

        </form>

      <% }%>
    </div>


<%- include("template/footer"); %>

<script>
  const formularioEditar = document.querySelector("#formularioEditar");
  formularioEditar.addEventListener("submit", async(e)=>{
    e.preventDefault();
    const nombre = formularioEditar.elements['nombre'].value;
    const descripcion = document.querySelector("#descripcion").value;
    const id = formularioEditar.dataset.id;
    try {
      const data = await fetch(`/mascotas/${id}`, {
        method: "PUT",
        headers: {
         'Content-Type': 'application/json'
         // 'Content-Type': 'application/x-www-form-urlencoded',
         },
        body: JSON.stringify({nombre:nombre, descripcion:descripcion})
      });
      const res = await data.json();
      if(res.estado){
        window.location.href = '/mascotas';
      }else {
        console.log(res);
      }
    } catch (error) {
        console.log(error);
    }
  })
</script>
